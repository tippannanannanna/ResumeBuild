<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Builder</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts for the "Inter" font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- jsPDF and docx libraries for file generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/docx@5.0.0/build/index.js"></script>
    <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 1024px;
        }
        /* Custom styles for the resume output */
        #resume-output h1,
        #resume-output h2 {
            text-transform: uppercase;
            font-weight: 700;
        }
        #resume-output h2 {
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 4px;
        }
        /* Modern Template Styles */
        .modern-template h1 {
            color: #4338ca; /* A shade of indigo */
            font-size: 2.5rem;
        }
        .modern-template h2 {
            border-bottom: 2px solid #6366f1; /* A brighter indigo */
            color: #4338ca;
        }
        .modern-template .skill-tag {
            background-color: #e0e7ff; /* A very light indigo */
            color: #4338ca;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8 flex items-center justify-center min-h-screen">

    <div class="container mx-auto bg-white rounded-xl shadow-lg p-6 sm:p-10 w-full">

        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">Simple Resume Builder</h1>
            <p class="text-gray-500 mt-2">Fill in your details and get an ATS-friendly resume instantly.</p>
        </header>

        <!-- Form Section -->
        <form id="resume-form" class="space-y-8">

            <!-- Basic Information -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Basic Information</h2>
                <div class="space-y-4">
                    <div>
                        <label for="fullName" class="block text-sm font-medium text-gray-700">1. Full Name</label>
                        <input type="text" id="fullName" name="fullName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border" required>
                    </div>
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700">2. Phone number</label>
                        <input type="tel" id="phone" name="phone" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border" required>
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">3. Email ID</label>
                        <input type="email" id="email" name="email" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border" required>
                    </div>
                    <div>
                        <label for="location" class="block text-sm font-medium text-gray-700">4. Location (city, state)</label>
                        <input type="text" id="location" name="location" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border" required>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="hasLinkedIn" name="hasLinkedIn" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                        <label for="hasLinkedIn" class="ml-2 block text-sm text-gray-700">5. I want to add a LinkedIn profile link</label>
                        <input type="url" id="linkedin" name="linkedin" placeholder="Paste your LinkedIn URL here" class="ml-4 mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border" style="display: none;">
                    </div>
                </div>
            </div>

            <!-- Career Objective -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Career Objective</h2>
                <div>
                    <label for="careerObjective" class="block text-sm font-medium text-gray-700">6. Write a short career objective/summary</label>
                    <textarea id="careerObjective" name="careerObjective" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border"></textarea>
                </div>
            </div>

            <!-- Work Experience -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Work Experience</h2>
                <div class="space-y-4">
                    <div>
                        <label for="jobTitle" class="block text-sm font-medium text-gray-700">7. Job Title (e.g., Cashier at Vishal Mega Mart)</label>
                        <input type="text" id="jobTitle" name="jobTitle" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                    <div>
                        <label for="duration" class="block text-sm font-medium text-gray-700">8. Duration (start month/year – end month/year)</label>
                        <input type="text" id="duration" name="duration" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                    <div>
                        <label for="responsibilities" class="block text-sm font-medium text-gray-700">9. Main Responsibilities (list them, separated by a comma or new line)</label>
                        <textarea id="responsibilities" name="responsibilities" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border"></textarea>
                    </div>
                    <div>
                        <label for="achievements" class="block text-sm font-medium text-gray-700">10. Achievements (list them, separated by a comma or new line)</label>
                        <textarea id="achievements" name="achievements" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border"></textarea>
                    </div>
                </div>
            </div>

            <!-- Skills -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Skills</h2>
                <div>
                    <label for="skills" class="block text-sm font-medium text-gray-700">11. Skills (list them, separated by a comma or new line)</label>
                    <textarea id="skills" name="skills" rows="3" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border"></textarea>
                </div>
            </div>

            <!-- Education -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Education</h2>
                <div class="space-y-4">
                    <div>
                        <label for="education" class="block text-sm font-medium text-gray-700">12. Your highest qualification (e.g., BA, 2022, University of XYZ)</label>
                        <input type="text" id="education" name="education" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="hasDeshpande" name="hasDeshpande" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500">
                        <label for="hasDeshpande" class="ml-2 block text-sm text-gray-700">13. I want to add my ongoing training at Deshpande Skilling</label>
                    </div>
                </div>
            </div>

            <!-- Certifications (Optional) -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Certifications (Optional)</h2>
                <div>
                    <label for="certifications" class="block text-sm font-medium text-gray-700">14. List any certifications (e.g., Meta Digital Marketing, Data Entry Operator)</label>
                    <textarea id="certifications" name="certifications" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border"></textarea>
                </div>
            </div>

            <!-- Extras -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Extras</h2>
                <div class="space-y-4">
                    <div>
                        <label for="languages" class="block text-sm font-medium text-gray-700">15. Languages Known (e.g., English, Kannada, Hindi)</label>
                        <input type="text" id="languages" name="languages" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                    <div>
                        <label for="hobbies" class="block text-sm font-medium text-gray-700">16. Hobbies/Interests (e.g., Reading, Hiking)</label>
                        <input type="text" id="hobbies" name="hobbies" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                    </div>
                </div>
            </div>

            <!-- Template Selection -->
            <div>
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">Template Selection</h2>
                <div>
                    <label for="template" class="block text-sm font-medium text-gray-700">Choose a template</label>
                    <select id="template" name="template" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm p-2 border">
                        <option value="classic">Classic</option>
                        <option value="modern">Modern</option>
                    </select>
                </div>
            </div>
            
            <button type="submit" class="w-full bg-indigo-600 text-white rounded-md py-3 font-semibold hover:bg-indigo-700 transition-colors duration-200">
                Generate Resume
            </button>

        </form>

        <!-- Resume Output Section (Hidden by default) -->
        <div id="resume-container" class="mt-8 hidden">
            <div id="resume-output" class="p-6 border border-gray-300 rounded-lg shadow-inner space-y-4">
                <!-- Resume content will be injected here -->
            </div>
            <div class="flex justify-center space-x-4 mt-6">
                <button id="download-pdf-button" class="bg-indigo-600 text-white rounded-md py-2 px-4 font-semibold hover:bg-indigo-700 transition-colors duration-200">
                    Download as PDF
                </button>
                <button id="download-docx-button" class="bg-green-600 text-white rounded-md py-2 px-4 font-semibold hover:bg-green-700 transition-colors duration-200">
                    Download as DOCX
                </button>
                <button id="back-button" class="bg-gray-200 text-gray-800 rounded-md py-2 px-4 font-semibold hover:bg-gray-300 transition-colors duration-200">
                    Edit Information
                </button>
            </div>
        </div>

    </div>

    <script>
        window.onload = function() {
            // Get DOM elements
            const form = document.getElementById('resume-form');
            const resumeContainer = document.getElementById('resume-container');
            const resumeOutput = document.getElementById('resume-output');
            const backButton = document.getElementById('back-button');
            const hasLinkedInCheckbox = document.getElementById('hasLinkedIn');
            const linkedinInput = document.getElementById('linkedin');
            const templateSelect = document.getElementById('template');
            const downloadPdfButton = document.getElementById('download-pdf-button');
            const downloadDocxButton = document.getElementById('download-docx-button');

            // Toggle LinkedIn input visibility
            hasLinkedInCheckbox.addEventListener('change', (e) => {
                linkedinInput.style.display = e.target.checked ? 'block' : 'none';
                if (!e.target.checked) {
                    linkedinInput.value = ''; // Clear value if unchecked
                }
            });

            // Handle form submission
            form.addEventListener('submit', (e) => {
                e.preventDefault();

                // Get form data
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());
                const selectedTemplate = templateSelect.value;

                // Add template class and generate resume HTML
                resumeOutput.className = 'p-6 border border-gray-300 rounded-lg shadow-inner space-y-4 ' + (selectedTemplate === 'modern' ? 'modern-template' : '');
                const resumeHTML = generateResume(data);
                
                // Inject HTML and show resume container
                resumeOutput.innerHTML = resumeHTML;
                form.classList.add('hidden');
                resumeContainer.classList.remove('hidden');
            });

            // Handle back button click
            backButton.addEventListener('click', () => {
                form.classList.remove('hidden');
                resumeContainer.classList.add('hidden');
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            // Handle PDF download
            downloadPdfButton.addEventListener('click', () => {
                // Get the resume content as a DOM element
                const element = document.getElementById('resume-output');

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                let y = 15; // starting y position
                const margin = 15;
                const lineHeight = 7;

                // Function to add text with wrapping
                const addText = (text, x, y, style = {}) => {
                    const splitText = doc.splitTextToSize(text, 180);
                    doc.text(splitText, x, y);
                    return y + (splitText.length * lineHeight);
                };

                // Add Full Name and contact info
                doc.setFontSize(22);
                doc.text(element.querySelector('h1').innerText, 105, y, null, null, 'center');
                y += 8;
                doc.setFontSize(10);
                const contactInfo = element.querySelector('p').innerText;
                addText(contactInfo, 105, y, { align: 'center' });
                y += 10;
                
                // Add all sections
                element.querySelectorAll('h2').forEach(heading => {
                    doc.setFontSize(16);
                    doc.setTextColor(51, 51, 51);
                    doc.text(heading.innerText, margin, y);
                    y += 5;
                    doc.setLineWidth(0.5);
                    doc.line(margin, y, 210 - margin, y);
                    y += 5;
                    
                    const sectionContent = heading.nextElementSibling;
                    doc.setFontSize(12);
                    doc.setTextColor(102, 102, 102);

                    if (heading.innerText.includes('CAREER OBJECTIVE')) {
                        y = addText(sectionContent.innerText, margin, y);
                        y += 5;
                    } else if (heading.innerText.includes('WORK EXPERIENCE')) {
                        const title = sectionContent.querySelector('h3').innerText;
                        const duration = sectionContent.querySelector('p').innerText;
                        doc.setFontSize(14);
                        doc.setTextColor(0, 0, 0);
                        doc.text(title, margin, y);
                        y += 5;
                        doc.setFontSize(10);
                        doc.setTextColor(102, 102, 102);
                        doc.text(duration, margin, y);
                        y += 5;
                        sectionContent.querySelectorAll('li').forEach(li => {
                            doc.setFontSize(12);
                            y = addText('• ' + li.innerText, margin, y);
                        });
                        y += 5;
                    } else if (heading.innerText.includes('SKILLS')) {
                        const skills = sectionContent.innerText.split(',').map(s => s.trim());
                        doc.setFontSize(12);
                        y = addText(skills.join(', '), margin, y);
                        y += 5;
                    } else if (heading.innerText.includes('EDUCATION')) {
                        sectionContent.querySelectorAll('p').forEach(p => {
                            y = addText(p.innerText, margin, y);
                        });
                        y += 5;
                    } else if (heading.innerText.includes('CERTIFICATIONS')) {
                        y = addText(sectionContent.innerText, margin, y);
                        y += 5;
                    } else if (heading.innerText.includes('ADDITIONAL INFORMATION')) {
                        sectionContent.querySelectorAll('p').forEach(p => {
                            y = addText(p.innerText, margin, y);
                        });
                        y += 5;
                    }
                });

                doc.save('my_resume.pdf');
            });

            // Handle DOCX download
            downloadDocxButton.addEventListener('click', () => {
                const formData = new FormData(form);
                const data = Object.fromEntries(formData.entries());

                const { Document, HeadingLevel, Paragraph, TextRun, Packer } = docx;

                const doc = new Document({
                    sections: [{
                        children: [
                            new Paragraph({
                                text: data.fullName,
                                heading: HeadingLevel.TITLE,
                                alignment: docx.AlignmentType.CENTER,
                            }),
                            new Paragraph({
                                text: `${data.location} | ${data.phone} | ${data.email}${data.hasLinkedIn ? ` | LinkedIn: ${data.linkedin}` : ''}`,
                                alignment: docx.AlignmentType.CENTER,
                                style: {
                                    font: 'Inter',
                                    size: 10,
                                    color: '808080'
                                }
                            }),
                            new Paragraph({ text: '' }), // Spacer
                            
                            // Career Objective
                            ... (data.careerObjective ? [
                                new Paragraph({ text: 'Career Objective', heading: HeadingLevel.HEADING_2 }),
                                new Paragraph({ text: data.careerObjective, style: 'Normal' }),
                            ] : []),
                            
                            // Work Experience
                            ... (data.jobTitle ? [
                                new Paragraph({ text: 'Work Experience', heading: HeadingLevel.HEADING_2 }),
                                new Paragraph({
                                    children: [
                                        new TextRun({ text: data.jobTitle, bold: true }),
                                        new TextRun({ text: `\n${data.duration}`, style: { italic: true } }),
                                    ],
                                }),
                                ... (data.responsibilities ? data.responsibilities.split(/[\n,]+/).map(item => new Paragraph({ text: item.trim(), bullet: { level: 0 } })) : []),
                                ... (data.achievements ? [
                                    new Paragraph({ text: 'Achievements:', bold: true }),
                                    ...data.achievements.split(/[\n,]+/).map(item => new Paragraph({ text: item.trim(), bullet: { level: 0 } })),
                                ] : []),
                            ] : []),

                            // Skills
                            ... (data.skills ? [
                                new Paragraph({ text: 'Skills', heading: HeadingLevel.HEADING_2 }),
                                new Paragraph({ text: data.skills }),
                            ] : []),

                            // Education
                            ... (data.education || data.hasDeshpande ? [
                                new Paragraph({ text: 'Education', heading: HeadingLevel.HEADING_2 }),
                                ... (data.education ? [new Paragraph({ text: data.education })] : []),
                                ... (data.hasDeshpande ? [new Paragraph({ text: 'Ongoing Training at Deshpande Skilling' })] : []),
                            ] : []),
                            
                            // Certifications
                            ... (data.certifications ? [
                                new Paragraph({ text: 'Certifications', heading: HeadingLevel.HEADING_2 }),
                                new Paragraph({ text: data.certifications }),
                            ] : []),

                            // Languages and Hobbies
                            ... (data.languages || data.hobbies ? [
                                new Paragraph({ text: 'Additional Information', heading: HeadingLevel.HEADING_2 }),
                                ... (data.languages ? [new Paragraph({ text: `Languages: ${data.languages}` })] : []),
                                ... (data.hobbies ? [new Paragraph({ text: `Interests: ${data.hobbies}` })] : []),
                            ] : []),
                        ],
                    }]
                });

                Packer.toBlob(doc).then(blob => {
                    saveAs(blob, 'my_resume.docx');
                });
            });

            /**
             * Generates the complete HTML string for the resume.
             * @param {object} data - The form data.
             * @returns {string} The HTML string for the resume.
             */
            function generateResume(data) {
                // Split multi-line or comma-separated strings into arrays
                const responsibilities = data.responsibilities ? data.responsibilities.split(/[\n,]+/).map(item => item.trim()).filter(item => item) : [];
                const achievements = data.achievements ? data.achievements.split(/[\n,]+/).map(item => item.trim()).filter(item => item) : [];
                const skills = data.skills ? data.skills.split(/[\n,]+/).map(item => item.trim()).filter(item => item) : [];

                return `
                    <div class="text-center pb-4">
                        <h1 class="text-3xl font-bold">${data.fullName}</h1>
                        <p class="text-gray-600 mt-1">${data.location} | ${data.phone} | ${data.email}
                            ${data.hasLinkedIn ? ` | <a href="${data.linkedin}" class="text-blue-500 hover:underline" target="_blank">LinkedIn</a>` : ''}
                        </p>
                    </div>

                    ${data.careerObjective ? `
                    <h2 class="text-xl text-gray-700 mt-4">Career Objective</h2>
                    <p class="text-gray-600 mt-2">${data.careerObjective}</p>
                    ` : ''}
                    
                    ${data.jobTitle && data.duration ? `
                    <h2 class="text-xl text-gray-700 mt-4">Work Experience</h2>
                    <div class="mt-2">
                        <h3 class="font-semibold text-gray-800">${data.jobTitle}</h3>
                        <p class="text-gray-500 italic text-sm">${data.duration}</p>
                        ${responsibilities.length > 0 ? `
                        <ul class="list-disc list-inside mt-2 text-gray-600 space-y-1 ml-4">
                            ${responsibilities.map(resp => `<li>${resp}</li>`).join('')}
                        </ul>
                        ` : ''}
                        ${achievements.length > 0 ? `
                        <p class="font-semibold text-gray-700 mt-2">Achievements:</p>
                        <ul class="list-disc list-inside mt-1 text-gray-600 space-y-1 ml-4">
                            ${achievements.map(ach => `<li>${ach}</li>`).join('')}
                        </ul>
                        ` : ''}
                    </div>
                    ` : ''}

                    ${skills.length > 0 ? `
                    <h2 class="text-xl text-gray-700 mt-4">Skills</h2>
                    <ul class="flex flex-wrap gap-2 mt-2 text-gray-600">
                        ${skills.map(skill => `<li class="bg-gray-200 rounded-full px-3 py-1 text-sm skill-tag">${skill}</li>`).join('')}
                    </ul>
                    ` : ''}

                    ${data.education || data.hasDeshpande ? `
                    <h2 class="text-xl text-gray-700 mt-4">Education</h2>
                    <div class="mt-2 text-gray-600">
                        ${data.education ? `<p>${data.education}</p>` : ''}
                        ${data.hasDeshpande ? `<p>Ongoing Training at Deshpande Skilling</p>` : ''}
                    </div>
                    ` : ''}

                    ${data.certifications ? `
                    <h2 class="text-xl text-gray-700 mt-4">Certifications</h2>
                    <p class="mt-2 text-gray-600">${data.certifications}</p>
                    ` : ''}

                    ${data.languages || data.hobbies ? `
                    <h2 class="text-xl text-gray-700 mt-4">Additional Information</h2>
                    <div class="mt-2 text-gray-600">
                        ${data.languages ? `<p><strong>Languages:</strong> ${data.languages}</p>` : ''}
                        ${data.hobbies ? `<p><strong>Interests:</strong> ${data.hobbies}</p>` : ''}
                    </div>
                    ` : ''}
                `;
            }
        };
    </script>
</body>
</html>
